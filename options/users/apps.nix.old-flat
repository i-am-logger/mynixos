{ lib, ... }:

let
  appLib = import ../../lib/app-options.nix { inherit lib; };
in
{
  options = {
    apps = lib.mkOption {
    type = lib.types.submodule {
      options = {
        communication = {
          element = appLib.mkAppEnableOption "Element Matrix client";
          signal = appLib.mkAppEnableOption "Signal Desktop messenger";
          slack = appLib.mkAppEnableOption "Slack communication tool";
        };

        security = {
          onePassword = appLib.mkAppOption {
            name = "1Password";
            default = false;
            description = "1Password password manager";
            persistedDirectories = [ ".config/1Password" ];
          };
        };

        terminals = {
          wezterm = appLib.mkAppOption {
            name = "WezTerm";
            default = true;
            description = "WezTerm terminal";
            persistedDirectories = [ ".config/wezterm" ];
          };
          kitty = appLib.mkAppEnableOption "Kitty terminal";
          ghostty = appLib.mkAppEnableOption "Ghostty terminal";
        };

        shells = {
          bash = appLib.mkAppEnableOption "Bash shell";
          fish = appLib.mkAppEnableOption "Fish shell";
        };

        prompts = {
          starship = appLib.mkAppOption {
            name = "Starship";
            default = true;
            description = "Starship prompt";
            persistedDirectories = [ ".config/starship" ];
          };
        };

        browsers = {
          brave = appLib.mkAppOption {
            name = "Brave";
            default = true;
            description = "Brave browser";
            persistedDirectories = [ ".config/BraveSoftware" ];
          };
          firefox = appLib.mkAppEnableOption "Firefox browser";
          chromium = appLib.mkAppOption {
            name = "Chromium";
            default = false;
            description = "Chromium browser";
            persistedDirectories = [ ".config/chromium" ];
          };
        };

        editors = {
          helix = appLib.mkAppOption {
            name = "Helix";
            default = true;
            description = "Helix editor";
            persistedDirectories = [ ".config/helix" ];
          };
          marktext = appLib.mkAppEnableOption "MarkText markdown editor";
        };

        fileManagers = {
          mc = appLib.mkAppEnableOption "Midnight Commander";
          yazi = appLib.mkAppOption {
            name = "Yazi";
            default = true;
            description = "Yazi TUI file manager";
            persistedDirectories = [ ".config/yazi" ];
          };
        };

        multiplexers = {
          zellij = appLib.mkAppOption {
            name = "Zellij";
            default = true;
            description = "Zellij multiplexer";
            persistedDirectories = [ ".config/zellij" ];
          };
          tmux = appLib.mkAppEnableOption "tmux multiplexer";
        };

        viewers = {
          bat = appLib.mkAppOption {
            name = "bat";
            default = true;
            description = "bat syntax highlighter";
            persistedDirectories = [ ];
          };
          feh = appLib.mkAppOption {
            name = "feh";
            default = true;
            description = "feh image viewer";
            persistedDirectories = [ ];
          };
        };

        fileUtils = {
          lsd = appLib.mkAppOption {
            name = "lsd";
            default = true;
            description = "lsd directory lister";
            persistedDirectories = [ ];
          };
        };

        sysinfo = {
          btop = appLib.mkAppEnableOption "btop system monitor";
          neofetch = appLib.mkAppEnableOption "neofetch system info";
          fastfetch = appLib.mkAppOption {
            name = "fastfetch";
            default = true;
            description = "fastfetch system info";
            persistedDirectories = [ ];
          };
        };

        visualizers = {
          cava = appLib.mkAppEnableOption "cava audio visualizer";
        };

        launchers = {
          walker = appLib.mkAppOption {
            name = "Walker";
            default = true;
            description = "Walker application launcher";
            persistedDirectories = [ ".config/walker" ];
          };
        };

        sync = {
          rclone = appLib.mkAppOption {
            name = "rclone";
            default = true;
            description = "rclone cloud sync";
            persistedDirectories = [ ".config/rclone" ];
          };
        };

        utils = {
          calculator = appLib.mkAppEnableOption "Calculator (qalculate)";
          imagemagick = appLib.mkAppOption {
            name = "ImageMagick";
            default = true;
            description = "ImageMagick image manipulation";
            persistedDirectories = [ ];
          };
        };

        dev = {
          direnv = appLib.mkAppOption {
            name = "direnv";
            default = true;
            description = "direnv environment manager";
            persistedDirectories = [ ".direnv" ".local/share/direnv" ];
          };
          devenv = appLib.mkAppEnableOption "devenv development environment manager";
          githubDesktop = appLib.mkAppEnableOption "GitHub Desktop";
          kdiff3 = appLib.mkAppEnableOption "KDiff3 diff tool";
          jq = appLib.mkAppOption {
            name = "jq";
            default = true;
            description = "jq JSON processor";
            persistedDirectories = [ ];
          };
          vscode = appLib.mkAppOption {
            name = "VSCode";
            default = true;
            description = "Visual Studio Code editor";
            persistedDirectories = [ ".vscode" ".claude" ];
          };
        };

        media = {
          pipewireTools = appLib.mkAppOption {
            name = "PipeWire Tools";
            default = true;
            description = "PipeWire CLI tools";
            persistedDirectories = [ ];
          };
          musikcube = appLib.mkAppEnableOption "musikcube music player";
          audacious = appLib.mkAppEnableOption "Audacious music player";
          audioUtils = appLib.mkAppOption {
            name = "Audio Utilities";
            default = true;
            description = "Audio utilities (pavucontrol, pamixer)";
            persistedDirectories = [ ];
          };
        };

        art = {
          mypaint = appLib.mkAppEnableOption "MyPaint drawing application";
        };

        network = {
          termscp = appLib.mkAppEnableOption "termscp TUI file transfer";
        };

        fun = {
          pipes = appLib.mkAppEnableOption "Terminal eye candy (pipes, neo, asciiquarium)";
        };

        finance = {
          cointop = appLib.mkAppEnableOption "Cointop cryptocurrency tracker";
        };
      };
    };
    default = { };
    description = "Per-user application configurations";
    };
  };
}
